import requests
import time
import random
with requests.Session() as s:
#     get_token = s.get("http://127.0.0.1/login.html")
#     csrf_token = re.search("csrfmiddlewaretoken\" value=\"(.*)?\"", get_token.text).group(1)
#    url = "http://127.0.0.1/login.html"
#     values = {
#         "uname" : "ACC2",
#         "pword" : "PASSWORD",
#         "csrfmiddlewaretoken" : csrf_token
#     }
#     req = s.post(url,data=values, allow_redirects = False)
#
#     for cookie in s.cookies:
#         cookie.secure = False
#
#     #url = "http://127.0.0.1:8080/htmltest.html"
#     url = "http://127.0.0.1/gift.html"
#     values = {
#       "amount" : random.randint(1, 200),
#       "username" : "LEGITLOGIN"
#     }
#     req = s.post(url,data=values)
#     result = req.text
#     print (req.text)
    url = "http://127.0.0.1:8989/gift.html"
    req = s.get(url, cookies = s.cookies)
    word = "csrfmiddlewaretoken"
    # print (req.text)
    result = req.text
    if word in result:
        print('NOT VULNERABLE to CSRF!')
    else:
        print('VULNERABLE to CSRF!')
